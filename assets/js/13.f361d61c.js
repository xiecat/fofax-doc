(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{417:function(t,a,s){"use strict";s.r(a);var n=s(52),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"编写-fx-语句"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#编写-fx-语句"}},[t._v("#")]),t._v(" 编写 Fx 语句")]),t._v(" "),s("h2",{attrs:{id:"生成模板文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#生成模板文件"}},[t._v("#")]),t._v(" 生成模板文件")]),t._v(" "),s("p",[t._v("使用 "),s("code",[t._v("-g")]),t._v(" 并指定生成的文件名指定路径，这样便生成了一个模版文件。默认是生成到当前目录下。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("fofax -g fx_rule.yaml\n")])])]),s("p",[t._v("查看此 yaml 文件，其内容如下。")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" fx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("2021"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("01")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("query")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' 查询的字符串用于fx="jupyter Unauth" eg'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("(jupyter Unauth)\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rule_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 规则名称 eg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("(jupyter 未授权)\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rule_english")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jupyter unauthorized\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("description")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 规则描述\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("author")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 作者<邮箱"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("eg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("(xiecat)\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("fofa_query")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" fofa语句 eg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v('(body="ipython'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v('app" '),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("&&")]),t._v(' title="Home Page '),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(' Select or create\n  a notebook")"\n'),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("tag")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 标签1 eg(unauthorized)\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 标签2\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("source")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 语句来源\n")])])]),s("p",[t._v("按照如上说明，修改相应内容，编写一个新的 Fx 语法规则。")]),t._v(" "),s("p",[t._v("为方便复制，详细内容如下（注意 title 处填写自己的目标名）：")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" fx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("2021"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("01")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("query")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" redteam"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("info"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("gathering\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rule_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 红队信息收集\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rule_english")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" redteam"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("info"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("gathering\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("description")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 使用fofa针对某个目标进行红队常见的高关注CMS/OA系统的信息收集\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("author")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" xiecat\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("fofa_query")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' title="Target" '),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("&&")]),t._v(' (title="平台" '),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(' title="OA" '),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(' title="系统" '),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(' title="协同" '),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(' title="办公" '),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(' title="致远" '),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(' title="泛微" '),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(' title="用友" '),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(' title="管理" '),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(' title="后台" '),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(' title="登录" '),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(' title="login" '),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(' title="admin") '),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("&&")]),t._v(' country="CN"\n'),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("tag")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" redteam\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("source")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" \n")])])]),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),s("p",[t._v("请务必保证 query 和 id 的全局唯一性,两者都不可以重复。如果提交到 FoFax, FoFaX 内部会有自己的编号。如果只是自己使用可以使用 fx-0000-xxxx 类似的编号。编号必须以 "),s("code",[t._v("fx")]),t._v(" 开头。")])]),t._v(" "),s("h2",{attrs:{id:"移动文件到-fxrules"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#移动文件到-fxrules"}},[t._v("#")]),t._v(" 移动文件到 "),s("code",[t._v("fxrules")])]),t._v(" "),s("p",[t._v("在编写完成后请放在 "),s("code",[t._v("fxrules")]),t._v(" 所在的目录。")]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),s("p",[s("code",[t._v("fxrules")]),t._v(" 目录有两种方法可以得知。一种是查看配置文件中 "),s("code",[t._v("fxdir")]),t._v(" 所在的目录。一种是通过 "),s("code",[t._v("fofax -h")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("FX GRAMMER:\n   -fd, -fxdir string        fxdir directory "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("default "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/Users/user/.config/fofax/fxrules"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("查看 "),s("code",[t._v("fxdir")]),t._v(" 的默认项")])]),t._v(" "),s("h2",{attrs:{id:"使用此-fx-查询规则"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用此-fx-查询规则"}},[t._v("#")]),t._v(" 使用此 Fx 查询规则")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("fofax -q 'fx=\"redteam-info-gathering\"' -fe -ffi\n")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);